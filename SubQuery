-- Atividades SubQuery Alessandro Mendes 

-- Exercício 1

SELECT 
    nome_funcionario
FROM
    funcionario
WHERE
    sigla_depto IN (SELECT 
            sigla_depto
        FROM
            departamento
        WHERE
            nome_depto LIKE '%cursos%')

-- Exercício 2

SELECT 
    nome_funcionario
FROM
    funcionario
WHERE
    codfuncionario IN (SELECT 
            codfuncionario
        FROM
            projeto
        WHERE
            sigla_depto LIKE '%MKT%' AND '%HR%')

-- Exercício 3

SELECT 
    nome_depto,
    (SELECT 
            SUM(salario) AS Total_Salario
        FROM
            funcionario)
FROM
    departamento

-- Exercício 4

SELECT 
    nome_funcionario
FROM
    funcionario
WHERE
    sigla_depto IN (SELECT 
            sigla_depto
        FROM
            projeto
        WHERE
            sigla_depto = 'it'
                AND funcionario.salario > (SELECT 
                    AVG(salario)
                FROM
                    funcionario))

 -- Exercício 5

SELECT 
    nome_depto,
    (SELECT 
            COUNT(funcionario)
        FROM
            funcionario
        WHERE
            funcionario.sigla_depto = departamento.sigla_depto) AS quantidadeFun
FROM
    departamento
 
 -- Exercício 6
 
SELECT 
    nome_funcionario
FROM
    funcionario
WHERE
    sigla_depto = 'hr'
        AND salario > (SELECT 
            AVG(salario)
        FROM
            funcionario
        WHERE
            sigla_depto = 'hr');

-- Exercício 7
SELECT 
    departamento.nome_depto,
    GROUP_CONCAT(funcionario.nome_funcionario separator ',')
FROM
    departamento,
    funcionario
WHERE
    departamento.sigla_depto = funcionario.sigla_depto
GROUP BY departamento.nome_depto;


 
 
